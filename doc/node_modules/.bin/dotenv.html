<!DOCTYPE html>
<html>
<head>
  <title>dotenv</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/.bin/dotenv";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>dotenv</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-meta">#!/usr/bin/env node</span>

<span class="hljs-keyword">var</span> spawn = <span class="hljs-built_in">require</span>(<span class="hljs-string">'cross-spawn'</span>)
<span class="hljs-keyword">var</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)

<span class="hljs-keyword">var</span> argv = <span class="hljs-built_in">require</span>(<span class="hljs-string">'minimist'</span>)(process.argv.slice(<span class="hljs-number">2</span>))
<span class="hljs-keyword">var</span> dotenv = <span class="hljs-built_in">require</span>(<span class="hljs-string">'dotenv'</span>)
<span class="hljs-keyword">var</span> dotenvExpand = <span class="hljs-built_in">require</span>(<span class="hljs-string">'dotenv-expand'</span>).expand

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">printHelp</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log([
    <span class="hljs-string">'Usage: dotenv [--help] [--debug] [-e &lt;path&gt;] [-v &lt;name&gt;=&lt;value&gt;] [-p &lt;variable name&gt;] [-c [environment]] [--no-expand] [-- command]'</span>,
    <span class="hljs-string">'  --help              print help'</span>,
    <span class="hljs-string">'  --debug             output the files that would be processed but don\'t actually parse them or run the `command`'</span>,
    <span class="hljs-string">'  -e &lt;path&gt;           parses the file &lt;path&gt; as a `.env` file and adds the variables to the environment'</span>,
    <span class="hljs-string">'  -e &lt;path&gt;           multiple -e flags are allowed'</span>,
    <span class="hljs-string">'  -v &lt;name&gt;=&lt;value&gt;   put variable &lt;name&gt; into environment using value &lt;value&gt;'</span>,
    <span class="hljs-string">'  -v &lt;name&gt;=&lt;value&gt;   multiple -v flags are allowed'</span>,
    <span class="hljs-string">'  -p &lt;variable&gt;       print value of &lt;variable&gt; to the console. If you specify this, you do not have to specify a `command`'</span>,
    <span class="hljs-string">'  -c [environment]    support cascading env variables from `.env`, `.env.&lt;environment&gt;`, `.env.local`, `.env.&lt;environment&gt;.local` files'</span>,
    <span class="hljs-string">'  --no-expand         skip variable expansion'</span>,
    <span class="hljs-string">'  -o, --override      override system variables'</span>,
    <span class="hljs-string">'  command             `command` is the actual command you want to run. Best practice is to precede this command with ` -- `. Everything after `--` is considered to be your command. So any flags will not be parsed by this tool but be passed to your command. If you do not do it, this tool will strip those flags'</span>
  ].join(<span class="hljs-string">'\n'</span>))
}

<span class="hljs-keyword">if</span> (argv.help) {
  printHelp()
  process.exit()
}

<span class="hljs-keyword">var</span> paths = []
<span class="hljs-keyword">if</span> (argv.e) {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> argv.e === <span class="hljs-string">'string'</span>) {
    paths.push(argv.e)
  } <span class="hljs-keyword">else</span> {
    paths.push(...argv.e)
  }
} <span class="hljs-keyword">else</span> {
  paths.push(<span class="hljs-string">'.env'</span>)
}

<span class="hljs-keyword">if</span> (argv.c) {
  paths = paths.reduce(<span class="hljs-function">(<span class="hljs-params">accumulator, path</span>) =&gt;</span> accumulator.concat(
    <span class="hljs-keyword">typeof</span> argv.c === <span class="hljs-string">'string'</span>
      ? [<span class="hljs-string">`<span class="hljs-subst">${path}</span>.<span class="hljs-subst">${argv.c}</span>.local`</span>, <span class="hljs-string">`<span class="hljs-subst">${path}</span>.local`</span>, <span class="hljs-string">`<span class="hljs-subst">${path}</span>.<span class="hljs-subst">${argv.c}</span>`</span>, path]
      : [<span class="hljs-string">`<span class="hljs-subst">${path}</span>.local`</span>, path]
  ), [])
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateCmdVariable</span> (<span class="hljs-params">param</span>) </span>{
  <span class="hljs-keyword">if</span> (!param.match(<span class="hljs-regexp">/^\w+=[a-zA-Z0-9"=^!?%@_&amp;\-/:;.]+$/</span>)) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">'Unexpected argument '</span> + param + <span class="hljs-string">'. Expected variable in format variable=value'</span>)
    process.exit(<span class="hljs-number">1</span>)
  }

  <span class="hljs-keyword">return</span> param
}
<span class="hljs-keyword">var</span> variables = []
<span class="hljs-keyword">if</span> (argv.v) {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> argv.v === <span class="hljs-string">'string'</span>) {
    variables.push(validateCmdVariable(argv.v))
  } <span class="hljs-keyword">else</span> {
    variables.push(...argv.v.map(validateCmdVariable))
  }
}
<span class="hljs-keyword">var</span> parsedVariables = dotenv.parse(Buffer.from(variables.join(<span class="hljs-string">'\n'</span>)))

<span class="hljs-keyword">if</span> (argv.debug) {
  <span class="hljs-built_in">console</span>.log(paths)
  <span class="hljs-built_in">console</span>.log(parsedVariables)
  process.exit()
}

paths.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">env</span>) </span>{
  <span class="hljs-keyword">const</span> override = argv.o || argv.override;
  <span class="hljs-keyword">var</span> parsedFile = dotenv.config({ <span class="hljs-attr">path</span>: path.resolve(env), override })
  <span class="hljs-keyword">if</span> (argv.expand !== <span class="hljs-literal">false</span>) {
    dotenvExpand(parsedFile)
  }
})
<span class="hljs-built_in">Object</span>.assign(process.env, parsedVariables)

<span class="hljs-keyword">if</span> (argv.p) {
  <span class="hljs-keyword">var</span> value = process.env[argv.p]
  <span class="hljs-built_in">console</span>.log(value != <span class="hljs-literal">null</span> ? value : <span class="hljs-string">''</span>)
  process.exit()
}

<span class="hljs-keyword">var</span> command = argv._[<span class="hljs-number">0</span>]
<span class="hljs-keyword">if</span> (!command) {
  printHelp()
  process.exit(<span class="hljs-number">1</span>)
}

spawn(command, argv._.slice(<span class="hljs-number">1</span>), { <span class="hljs-attr">stdio</span>: <span class="hljs-string">'inherit'</span> })
  .on(<span class="hljs-string">'exit'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">exitCode, signal</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> exitCode === <span class="hljs-string">'number'</span>) {
      process.exit(exitCode)
    } <span class="hljs-keyword">else</span> {
      process.kill(process.pid, signal)
    }
  })

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
